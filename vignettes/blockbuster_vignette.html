<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Matthew Gregory" />

<meta name="date" content="2017-02-04" />

<title>Blockbuster modelling: wow; what a difference!</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Blockbuster modelling: wow; what a difference!</h1>
<h4 class="author"><em>Matthew Gregory</em></h4>
<h4 class="date"><em>2017-02-04</em></h4>



<blockquote>
<p>“”Can I have a P please, Bob?“.” (<a href="http://www.bbc.co.uk/news/entertainment-arts-16447409">via</a>)</p>
</blockquote>
<div id="modelling-deterioration-of-the-school-estate-using-discrete-time-markov-chains" class="section level2">
<h2>Modelling deterioration of the School Estate using Discrete-Time Markov chains</h2>
<p>A useful package of functions and sample data to forecast the future condition of School blocks (or buildings) in the UK.</p>
<div id="modelling-overview" class="section level3">
<h3>Modelling overview</h3>
<p>Markov chains represent a class of stochastic processes of great interest for the wide spectrum of practical applications. In particular, discrete time <a href="https://cran.r-project.org/web/packages/markovchain/vignettes/an_introduction_to_markovchain_package.pdf">Markov chains</a> (DTMC) permit to model the transition probabilities between discrete states by the aid of matrices. The states are represented by the <code>grade</code> factor which is the surveyed condition of a building element, determined by a quantity surveyor through grades (states); N, A, B, C, D, E. The transition probabilities are 6 by 6 matrices with the average deterioration rate per timestep between states provided by expert building consultant opinion (see documentation for full details).</p>
</div>
<div id="business-questions-it-can-answer" class="section level3">
<h3>Business questions it can answer</h3>
<p>This package is useful for decision makers as it provides a modelling approach for forecasting the condition of an individual building component (<code>elementid</code>) through time. This modelling approach can be scaled through a decision making hierarchy, with modelling the deterioration at the level of a School block (<code>buildingid</code>), for each site (<code>siteid</code>), the School (which may be made of many blocks, <code>urn</code>), at the Local Authority (LA) level (<code>lano</code>) and at the National level given suitable input data (filter desired rows using the <code>dplyr</code> package is recommended).</p>
<p>The <code>blockbuster</code> function can be used on more than one row of what I call a <code>blockbuster_tibble</code> through more than one year, storing or the data of intermediary years. This flexibility allows decision makers to ask many and varied questions of the output data.</p>
</div>
</div>
<div id="loading-the-packages" class="section level2">
<h2>Loading the packages</h2>
<p>Check you have these packages installed and then load them into memory using <code>require()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)  <span class="co">#  Recommended for filterting rows desired for input.</span>
<span class="kw">library</span>(markovchain)  <span class="co">#  Recommended for markovchain S4 object handling (advanced).</span>

<span class="kw">library</span>(blockbuster)  <span class="co">#  Required.</span></code></pre></div>
</div>
<div id="the-initial-state-data" class="section level2">
<h2>The initial state data</h2>
<p>Provided with this package is some sampled data with identifying features removed. We suggest loading the <code>tidyverse</code> package when handling this data. This object is a tibble called by <code>blockbuster_pds</code>. For creating a subset of this data to make it manageable for simulation, use the <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html"><code>dplyr</code> package</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr::<span class="kw">glimpse</span>(blockbuster_pds)</code></pre></div>
<pre><code>## Observations: 254,878
## Variables: 25
## $ lano                  &lt;int&gt; 331, 331, 331, 331, 331, 331, 331, 331, ...
## $ siteid                &lt;int&gt; 1266, 1266, 1266, 1266, 1266, 1266, 1266...
## $ buildingid            &lt;int&gt; 4382, 4382, 4382, 4382, 4382, 4382, 4382...
## $ elementid             &lt;int&gt; 1700, 1701, 1706, 1972, 1719, 1714, 1716...
## $ element               &lt;fctr&gt; Roofs, Roofs, Roofs, Roofs, Roofs, Roof...
## $ sub_element           &lt;fctr&gt; Structure, Structure, Coverings and ins...
## $ const_type            &lt;fctr&gt; Flat roof  structure and deck - General...
## $ const_type_accessible &lt;fctr&gt; No, No, Yes, Yes, Yes, Yes, Yes, Yes, Y...
## $ grade                 &lt;fctr&gt; A, A, B, B, A, C, A, B, B, A, B, A, A, ...
## $ cost                  &lt;dbl&gt; 0.00, 0.00, 3910.23, 10335.08, 0.00, 672...
## $ composition           &lt;dbl&gt; 0.30, 0.70, 0.30, 0.70, 0.35, 0.30, 0.35...
## $ storeys               &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3...
## $ gifa                  &lt;dbl&gt; 1916, 1916, 1916, 1916, 1916, 1916, 1916...
## $ ground_gifa           &lt;dbl&gt; 1028, 1028, 1028, 1028, 1028, 1028, 1028...
## $ block_perimeter       &lt;dbl&gt; 167, 167, 167, 167, 167, 167, 167, 167, ...
## $ height                &lt;dbl&gt; 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8...
## $ windows_doors         &lt;dbl&gt; 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ...
## $ number_lifts          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ site_area_exc_field   &lt;dbl&gt; 2100, 2100, 2100, 2100, 2100, 2100, 2100...
## $ boundary_length       &lt;dbl&gt; 250, 250, 250, 250, 250, 250, 250, 250, ...
## $ field_area            &lt;dbl&gt; 1000, 1000, 1000, 1000, 1000, 1000, 1000...
## $ swimming_pool         &lt;fctr&gt; No, No, No, No, No, No, No, No, No, No,...
## $ timestep              &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ unit_area             &lt;dbl&gt; 308.4, 719.6, 308.4, 719.6, 359.8, 308.4...
## $ cost_sum              &lt;dbl&gt; 133987, 133987, 133987, 133987, 133987, ...</code></pre>
</div>
<div id="the-transition-probability-data" class="section level2">
<h2>The transition probability data</h2>
<p>The deterioration rates can be called by using either the tibble <code>blockbuster_det_data</code> or the <code>markovchainList</code> object <code>blockbuster_mc_list</code>. For example let’s inspect the first example of each.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">blockbuster_det_data[<span class="dv">1</span>, ]</code></pre></div>
<pre><code>## # A tibble: 1 × 9
##   element sub_element const_type    na      ab      bc      cd      de
##     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1   Roofs       ROOFS      ROOFS   0.5 0.03862 0.06437 0.15015 0.25342
## # ... with 1 more variables: concated_det &lt;chr&gt;</code></pre>
<p>This identifies the building component through the <code>element</code>, <code>sub_elment</code> and <code>const_type</code>. The “two-letter” variables describe the transition rate or probability from the first letter condition grade to the second letter condition grade. For example, for this building component (here <code>concated_det</code>), the <code>cd</code> describes the proportion of the <code>unit_area</code> at <code>grade == C</code> that will transition to <code>grade == D</code> through one timestep or year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">blockbuster_mc_list@markovchains[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## Roofs_ROOFS_ROOFS 
##  A  6 - dimensional discrete Markov Chain defined by the following states: 
##  n, a, b, c, d, e 
##  The transition matrix  (by rows)  is defined as follows: 
##     n       a       b       c       d       e
## n 0.5 0.50000 0.00000 0.00000 0.00000 0.00000
## a 0.0 0.96138 0.03862 0.00000 0.00000 0.00000
## b 0.0 0.00000 0.93563 0.06437 0.00000 0.00000
## c 0.0 0.00000 0.00000 0.84985 0.15015 0.00000
## d 0.0 0.00000 0.00000 0.00000 0.74658 0.25342
## e 0.0 0.00000 0.00000 0.00000 0.00000 1.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># isS4(blockbuster_mc_list@markovchains[[1]])  #  TRUE</span></code></pre></div>
<p><code>blockbuster_mc_list</code> is a S4 object so the data needs to be accessed through its slots. They hold the same data in different ways. The S4 method may be useful in the future when incorporating some functions from the <code>markovchain</code> package.</p>
</div>
<div id="the-blockbuster-functions" class="section level2">
<h2>The blockbuster functions</h2>
<p>We consider the first row of this sampled data which is a roof of excellent <code>grade</code> A condition with a <code>unit_area</code> of 308.4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>blockbuster_pds[<span class="dv">1</span>, ]
dplyr::<span class="kw">select</span>(x, element, sub_element, const_type, grade, unit_area)</code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   element sub_element                                const_type  grade
##    &lt;fctr&gt;      &lt;fctr&gt;                                    &lt;fctr&gt; &lt;fctr&gt;
## 1   Roofs   Structure Flat roof  structure and deck - Generally      A
## # ... with 1 more variables: unit_area &lt;dbl&gt;</code></pre>
</div>
<div id="inspecting-the-associated-deterioration-rates" class="section level2">
<h2>Inspecting the associated deterioration rates</h2>
<p>To determine which transition matrix is associated with each row we use the <code>det_what_tm()</code> function. This produces an error if the <code>markovchain</code> object does not exist. This works by concatenating the <code>element</code>, <code>sub_elment</code> and <code>const_type</code> and matching with the <code>concated_det</code> we saw earlier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc1 &lt;-<span class="st"> </span><span class="kw">det_what_tm</span>(x)
mc1</code></pre></div>
<pre><code>## Roofs_STRUCTURE_Flat roof  structure and deck - Generally 
##  A  6 - dimensional discrete Markov Chain defined by the following states: 
##  n, a, b, c, d, e 
##  The transition matrix  (by rows)  is defined as follows: 
##     n     a       b       c       d       e
## n 0.5 0.500 0.00000 0.00000 0.00000 0.00000
## a 0.0 0.953 0.04700 0.00000 0.00000 0.00000
## b 0.0 0.000 0.92166 0.07834 0.00000 0.00000
## c 0.0 0.000 0.00000 0.81199 0.18801 0.00000
## d 0.0 0.000 0.00000 0.00000 0.68664 0.31336
## e 0.0 0.000 0.00000 0.00000 0.00000 1.00000</code></pre>
<p>This is a <code>markovchain</code> object as described in the documentation of that package. It is a S4 object and we can access different components using slots and <code>[</code> sub-setting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc1@transitionMatrix[, ]  <span class="co">#  [i, j] i for row, j column</span></code></pre></div>
<pre><code>##     n     a       b       c       d       e
## n 0.5 0.500 0.00000 0.00000 0.00000 0.00000
## a 0.0 0.953 0.04700 0.00000 0.00000 0.00000
## b 0.0 0.000 0.92166 0.07834 0.00000 0.00000
## c 0.0 0.000 0.00000 0.81199 0.18801 0.00000
## d 0.0 0.000 0.00000 0.00000 0.68664 0.31336
## e 0.0 0.000 0.00000 0.00000 0.00000 1.00000</code></pre>
</div>
<div id="deteriorating-through-time" class="section level2">
<h2>Deteriorating through time</h2>
<p>Typically the user will be interested in a subset of the data. Consult the <code>dplyr</code> vignette for handling and sub-setting your data based on desired filter conditions.</p>
<p>Here we demonstrate the deterioration of a single element through time. We chose a critical building feature of one particular block or building we are interested in.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_wall &lt;-<span class="st"> </span>dplyr::<span class="kw">filter</span>(blockbuster_pds,
                         buildingid ==<span class="st"> </span><span class="dv">4382</span>, sub_element ==<span class="st"> &quot;Walls - Structure&quot;</span>, 
                         const_type ==<span class="st"> &quot;Brick / block&quot;</span>)

my_wall_next_year &lt;-<span class="st"> </span><span class="kw">blockbuster</span>(my_wall, <span class="dv">1</span>)
my_wall_next_year</code></pre></div>
<pre><code>## [[1]]
## # A tibble: 1 × 25
##    lano siteid buildingid elementid                           element
##   &lt;int&gt;  &lt;int&gt;      &lt;int&gt;     &lt;int&gt;                            &lt;fctr&gt;
## 1   331   1266       4382      1828 External Walls, Windows and Doors
## # ... with 20 more variables: sub_element &lt;fctr&gt;, const_type &lt;fctr&gt;,
## #   const_type_accessible &lt;fctr&gt;, grade &lt;fctr&gt;, cost &lt;dbl&gt;,
## #   composition &lt;dbl&gt;, storeys &lt;dbl&gt;, gifa &lt;dbl&gt;, ground_gifa &lt;dbl&gt;,
## #   block_perimeter &lt;dbl&gt;, height &lt;dbl&gt;, windows_doors &lt;dbl&gt;,
## #   number_lifts &lt;dbl&gt;, site_area_exc_field &lt;dbl&gt;, boundary_length &lt;dbl&gt;,
## #   field_area &lt;dbl&gt;, swimming_pool &lt;fctr&gt;, timestep &lt;int&gt;,
## #   unit_area &lt;dbl&gt;, cost_sum &lt;dbl&gt;
## 
## [[2]]
## # A tibble: 2 × 25
##    lano siteid buildingid elementid                           element
##   &lt;int&gt;  &lt;int&gt;      &lt;int&gt;     &lt;int&gt;                            &lt;fctr&gt;
## 1   331   1266       4382      1828 External Walls, Windows and Doors
## 2   331   1266       4382      1828 External Walls, Windows and Doors
## # ... with 20 more variables: sub_element &lt;fctr&gt;, const_type &lt;fctr&gt;,
## #   const_type_accessible &lt;fctr&gt;, grade &lt;fctr&gt;, cost &lt;dbl&gt;,
## #   composition &lt;dbl&gt;, storeys &lt;dbl&gt;, gifa &lt;dbl&gt;, ground_gifa &lt;dbl&gt;,
## #   block_perimeter &lt;dbl&gt;, height &lt;dbl&gt;, windows_doors &lt;dbl&gt;,
## #   number_lifts &lt;dbl&gt;, site_area_exc_field &lt;dbl&gt;, boundary_length &lt;dbl&gt;,
## #   field_area &lt;dbl&gt;, swimming_pool &lt;fctr&gt;, timestep &lt;dbl&gt;,
## #   cost_sum &lt;dbl&gt;, unit_area &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_wall_20year &lt;-<span class="st"> </span><span class="kw">blockbuster</span>(my_wall, <span class="dv">20</span>)</code></pre></div>
<p>This produces a list of tibbles. Each tibble provides the condition of the input tibble at that timestep. Notice how the number of rows has increased. That’s because we have a row for each <code>grade</code> state and associated <code>unit_area</code>. The first tibble in the list is for the input data or <code>timestep == 0</code>. It is prudent to check the timestep by inspecting it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_wall_next_year[[<span class="dv">2</span>]]</code></pre></div>
<pre><code>## # A tibble: 2 × 25
##    lano siteid buildingid elementid                           element
##   &lt;int&gt;  &lt;int&gt;      &lt;int&gt;     &lt;int&gt;                            &lt;fctr&gt;
## 1   331   1266       4382      1828 External Walls, Windows and Doors
## 2   331   1266       4382      1828 External Walls, Windows and Doors
## # ... with 20 more variables: sub_element &lt;fctr&gt;, const_type &lt;fctr&gt;,
## #   const_type_accessible &lt;fctr&gt;, grade &lt;fctr&gt;, cost &lt;dbl&gt;,
## #   composition &lt;dbl&gt;, storeys &lt;dbl&gt;, gifa &lt;dbl&gt;, ground_gifa &lt;dbl&gt;,
## #   block_perimeter &lt;dbl&gt;, height &lt;dbl&gt;, windows_doors &lt;dbl&gt;,
## #   number_lifts &lt;dbl&gt;, site_area_exc_field &lt;dbl&gt;, boundary_length &lt;dbl&gt;,
## #   field_area &lt;dbl&gt;, swimming_pool &lt;fctr&gt;, timestep &lt;dbl&gt;,
## #   cost_sum &lt;dbl&gt;, unit_area &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(my_wall_next_year[[<span class="dv">2</span>]]$timestep, <span class="dv">1</span>)  <span class="co">#  1 timestep later than initial</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="blockbusting-through-many-rows" class="section level2">
<h2>Blockbusting through many rows</h2>
<p>The same principle applies as above where we pass the <code>blockbuster</code> function an input tibble object and the number of years into the future (relative to when the data was collected) we want to model to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span>blockbuster_pds[<span class="dv">1</span>:<span class="dv">20</span>, ]  <span class="co">#  select all rows associated with decision level of interest, perhaps one block or one LA?</span>
my_block_10years &lt;-<span class="st"> </span><span class="kw">blockbuster</span>(y, <span class="dv">10</span>)
dplyr::<span class="kw">select</span>(my_block_10years[[<span class="dv">11</span>]], buildingid, elementid, grade, unit_area) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">arrange</span>(elementid, grade)</code></pre></div>
<pre><code>## # A tibble: 89 × 4
##    buildingid elementid  grade   unit_area
##         &lt;int&gt;     &lt;int&gt; &lt;fctr&gt;       &lt;dbl&gt;
## 1        4382      1700      A 190.5651038
## 2        4382      1700      B  81.2268898
## 3        4382      1700      C  21.7992880
## 4        4382      1700      D   8.2638365
## 5        4382      1700      E   6.5448820
## 6        4382      1701      A 584.9129266
## 7        4382      1701      B 115.0598531
## 8        4382      1701      C  15.7167642
## 9        4382      1701      D   3.0563950
## 10       4382      1701      E   0.8540611
## # ... with 79 more rows</code></pre>
</div>
<div id="computation-time" class="section level2">
<h2>Computation time</h2>
<p>I suggest you spend time thinking about the precise question you are asking rather than using the whole <code>blockbuster_pds</code> tibble as input due to non-trivial computation time. As a rule of thumb the amount of rows you start with will be multiplied by five (as each <code>elementid</code> deteriorates to other states), with each of these tibbles being multiplied by the <code>forecast_horizon</code>. That’s quite a lot of data and may tax your computer’s RAM (although the <code>unit_area</code> and <code>timestep</code> will be the only variables changing through time).</p>
</div>
<div id="plotting-output-basics" class="section level2">
<h2>Plotting output basics</h2>
<p>The tibble format is compatible with the <code>tidyverse</code> particularly <code>reshape2</code>-ing and plotting using <code>ggplot2</code>. The <code>purrr</code> package and the excellent <code>map_df()</code> function makes it easy to plot data from multiple dataframes across a list, as is the case with our <code>blockbuster</code> output.</p>
<div id="blockbusting" class="section level3">
<h3>Blockbusting</h3>
<p>We can investigate the rate at which our critical elements are deteriorating or even what proportion of the <code>unit_area</code> is decommisioned. Given the flexibility of the model output we can ask anything of the data.</p>
<p>Here we are interested in tracking the deterioration of critical building components in our block of interest. We recycle the <code>my_wall_20year</code> object for this question. The wall starts as all condition grade B then gradually deteriorates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p4 &lt;-<span class="st"> </span>my_wall_20year %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(timestep, grade) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarise</span>(<span class="dt">sum_area =</span> <span class="kw">sum</span>(unit_area, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> sum_area, <span class="dt">x =</span> grade)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) +
<span class="st">  </span>ggplot2::<span class="kw">facet_wrap</span>(
    ~timestep
  )

p4 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Estimated area (m^2)&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Condition grade&quot;</span>) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="critical-building-elements" class="section level3">
<h3>Critical building elements</h3>
<p>Typically we may be more interested in critical, structural building-features such as the roof or walls and whether the <code>unit_area</code> exceeds a critical threshold determined by expert opinion. For example, is our wall’s total <code>unit_area</code> after 10 years comprised of over 20% grade D and E? We plot then expect the numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_wall_10 &lt;-<span class="st"> </span><span class="kw">blockbuster</span>(my_wall, <span class="dv">10</span>)
<span class="co">#  We are interested in the 10 th (+ 1) timestep</span>
df &lt;-<span class="st"> </span>my_wall_10[[<span class="dv">11</span>]]

<span class="co">#  Use gov style for plot, install these if you don't have them</span>
<span class="co"># devtools::install_github('mangothecat/visualTest')  #  required for govstyle</span>
<span class="co"># devtools::install_github(&quot;UKGov-Data-Science/govstyle&quot;)</span>

p &lt;-<span class="st"> </span>ggplot2::<span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> grade, <span class="dt">y =</span> unit_area)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> govstyle::gov_cols[<span class="st">'turquoise'</span>]) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Condition&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(
  <span class="st">&quot;Unit area (&quot;</span>,m^<span class="dv">2</span>,
  <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>()

p </code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We use <code>dplyr</code> to elucidate and determine that our wall is below our arbitrary 20% threshold, if we wanted to scale this we could create a new variable using <code>mutate</code> which is based on a logical test. The only limit is your imagination (and coding skills).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">total_wall_area &lt;-<span class="st"> </span><span class="kw">sum</span>(df$unit_area)
dplyr::<span class="kw">mutate</span>(df, <span class="dt">prop_area =</span> unit_area /<span class="st"> </span>total_wall_area) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(grade, unit_area, prop_area)</code></pre></div>
<pre><code>## # A tibble: 4 × 3
##    grade unit_area  prop_area
##   &lt;fctr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1      B 883.40640 0.66621900
## 2      C 283.94409 0.21413581
## 3      D 101.28156 0.07638127
## 4      E  57.36795 0.04326392</code></pre>
</div>
</div>
<div id="costing" class="section level2">
<h2>Costing</h2>
<p>The costing part of the <code>blockbuster</code> function is built using an internal function called <code>blockcoster_lookup</code>. This takes the building component and condition grade information and looks this character string up in the <code>blockbuster_pds_repair_costs</code> tibble, thus finding the appropriate repair costs constant to multiply the <code>unit_area</code> of that building component by.</p>
<p>Currently it will return <code>NA</code> for grade E. This due to lack of data on repairing a building component from grade E back to A, furthermore as grade E is meant to encapsulate a decommisioned status for now it is deemed more appropriate to only be able to get E back to grade N through rebuilding. Costs are calculated for each row. The <code>cost_sum</code> variable is set to zero as this can be recalculated later if required, as it requires an aggregation by <code>buildingid</code> step.</p>
<div id="blockcosting" class="section level3">
<h3>Blockcosting</h3>
<p>We continue with the examples from above by considering the aggregated cost of repairs through time. Let us plot the distribution of costs by condition grade using a box plot through each year. Repair costs from grade A should always be zero as they are already in excellent condition and do not need any work. This plot shows how the median costs for each grade steadily increase year on year with some building components in particularly deteriorating quickly and in a costly fashion (the outliers indicated by the black circles).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  http://www.machinegurning.com/rstats/map_df/</span>

<span class="co"># </span>
<span class="co"># cool_cars &lt;- list(mtcars, mtcars, mtcars) %&gt;%</span>
<span class="co">#   map_df(</span>
<span class="co">#     ~ .x ,</span>
<span class="co">#     .id = &quot;year&quot;</span>
<span class="co">#   ) %&gt;%</span>
<span class="co">#   group_by(&quot;year&quot;) %&gt;%</span>
<span class="co">#   ggplot(aes(x = cyl, y = disp, group = cyl)) +</span>
<span class="co">#   geom_boxplot() +</span>
<span class="co">#   facet_wrap(</span>
<span class="co">#     ~year</span>
<span class="co">#   )</span>
<span class="co"># cool_cars</span>

p2 &lt;-<span class="st"> </span>my_block_10years %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(<span class="st">&quot;timestep&quot;</span>) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> grade, <span class="dt">y =</span> cost)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_boxplot</span>() +
<span class="st">  </span>ggplot2::<span class="kw">facet_wrap</span>(
    ~timestep
  )

p2 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Cost of repairs (£)&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Condition grade&quot;</span>) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>()</code></pre></div>
<pre><code>## Warning: Removed 151 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="total-blockcosting" class="section level3">
<h3>Total Blockcosting</h3>
<p>We take our hypothetical building and plot the total costs year on year by condition grade. Notice how the costs to repair the hypothetical block increase until a maximum around seven years at which it reaches a balance. However, this ignores the amount of building component going into the decommissioned status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p3 &lt;-<span class="st"> </span>my_block_10years %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(timestep, grade) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarise</span>(<span class="dt">sum_cost =</span> <span class="kw">sum</span>(cost, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> grade, <span class="dt">y =</span> sum_cost)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) +
<span class="st">  </span>ggplot2::<span class="kw">facet_wrap</span>(
    ~timestep
  )

p3 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Total cost of repairs (£)&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Condition grade&quot;</span>) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="line-plot" class="section level3">
<h3>Line plot</h3>
<p>The blockbuster output is flexible and amenable to data manipulation and or transformation prior to plotting. The user is only limited by their imagination.</p>
<p>Below we present a standard output that is seen in many reports of the School Estate. Here we plot the total costs by aggregated by condition grade for each year. Note how the <code>theme_gov()</code> style omits the legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p4 &lt;-<span class="st"> </span>my_block_10years %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(timestep, grade) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarise</span>(<span class="dt">sum_cost =</span> <span class="kw">sum</span>(cost, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> timestep, <span class="dt">y =</span> sum_cost, <span class="dt">group =</span> grade, <span class="dt">colour =</span> grade)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>)
  

p4 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Total cost of repairs (£)&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Years after PDS&quot;</span>) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>()  <span class="co">#  doesn't produce a legend</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="digging-down" class="section level3">
<h3>Digging down</h3>
<blockquote>
<p>Better to draw several approximate graphics saying something about the right question than to draw one precise graphicrelating to the wrong question.</p>
</blockquote>
<p>The above graphic ignores the grade E or decommisioned building components that do not contribute to the total cost of repairs but will need to be addressed usually by reubilding of the whole block. Be imaginative and try plenty of variety in your plots.</p>
<div id="total-costs-by-building-element" class="section level4">
<h4>Total costs by building element</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p5 &lt;-<span class="st"> </span>my_block_10years %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(timestep, element) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarise</span>(<span class="dt">sum_cost =</span> <span class="kw">sum</span>(cost, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> element, <span class="dt">y =</span> sum_cost)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) +
<span class="st">  </span>ggplot2::<span class="kw">facet_wrap</span>(
    ~timestep
  )

p5 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Total cost of repairs (£)&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Building element&quot;</span>) +
<span class="st">  </span>govstyle::<span class="kw">theme_gov</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="subsetting-the-blockbuster-list-output-for-specified-years-of-interest" class="section level4">
<h4>Subsetting the blockbuster list output for specified years of interest</h4>
<p>Perhaps we are interested in just the last couple of years of the simulation? We can subset a single year of interest or dataframe from the list using the normal R syntax.</p>
<p>The following graph also highlights a flaw in the earlier generation of the deterioration model which just considerd the <code>unit_area</code> of a building component and ignored the building component <code>element</code>, <code>sub_element</code> or <code>const_type</code> type in its calculations. The blockbuster model considers this when estimating repair costs. In the figure below we aggregate across building <code>element</code> the total <code>unit_area</code> and <code>cost</code> of repairs and plot using the extra dimensions afforded by shape and colour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p6 &lt;-<span class="st"> </span>my_block_10years[<span class="dv">11</span>] %&gt;%
<span class="st">  </span>purrr::<span class="kw">map_df</span>(
    ~<span class="st"> </span>.x ,
    <span class="dt">.id =</span> <span class="ot">NULL</span>
  ) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(timestep, grade, <span class="dt">element_shrt =</span> <span class="kw">as.factor</span>(<span class="kw">abbreviate</span>(element, <span class="dv">14</span>))) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarise</span>(<span class="dt">sum_unit_area =</span> <span class="kw">sum</span>(unit_area, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                   <span class="dt">sum_cost =</span> <span class="kw">sum</span>(cost, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span>ggplot2::<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sum_unit_area, <span class="dt">y =</span> sum_cost, <span class="dt">colour =</span> grade,
                      <span class="dt">shape =</span> element_shrt)) +
<span class="st">  </span>ggplot2::<span class="kw">geom_point</span>() +
<span class="st">  </span>ggplot2::<span class="kw">facet_wrap</span>(
    ~<span class="st"> </span>timestep
  )

p6 +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Cost of repairs&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Unit area (m^2)&quot;</span>) +<span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  govstyle::<span class="kw">theme_gov</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<pre><code>## List of 18
##  $ legend.position : chr &quot;none&quot;
##  $ axis.ticks      : list()
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_blank&quot; &quot;element&quot;
##  $ axis.line       :List of 4
##   ..$ colour  : chr &quot;gray40&quot;
##   ..$ size    : NULL
##   ..$ linetype: NULL
##   ..$ lineend : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_line&quot; &quot;element&quot;
##  $ axis.line.x     :List of 4
##   ..$ colour  : chr &quot;gray40&quot;
##   ..$ size    : NULL
##   ..$ linetype: NULL
##   ..$ lineend : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_line&quot; &quot;element&quot;
##  $ axis.line.y     :List of 4
##   ..$ colour  : chr &quot;white&quot;
##   ..$ size    : NULL
##   ..$ linetype: NULL
##   ..$ lineend : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_line&quot; &quot;element&quot;
##  $ text            :List of 10
##   ..$ family    : NULL
##   ..$ face      : chr &quot;plain&quot;
##   ..$ colour    : chr &quot;gray40&quot;
##   ..$ size      : num 12
##   ..$ hjust     : num 0.5
##   ..$ vjust     : num 0.5
##   ..$ angle     : num 0
##   ..$ lineheight: num 0.8
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ axis.text       :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : chr &quot;gray40&quot;
##   ..$ size      : NULL
##   ..$ hjust     : NULL
##   ..$ vjust     : NULL
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ plot.title      :List of 10
##   ..$ family    : NULL
##   ..$ face      : chr &quot;bold&quot;
##   ..$ colour    : chr &quot;black&quot;
##   ..$ size      : NULL
##   ..$ hjust     : num 1
##   ..$ vjust     : num -2.5
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ axis.title.y    :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : NULL
##   ..$ size      : NULL
##   ..$ hjust     : num 1
##   ..$ vjust     : num 1
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ axis.title.x    :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : NULL
##   ..$ size      : NULL
##   ..$ hjust     : num 1
##   ..$ vjust     : num 6
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ panel.background: list()
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_blank&quot; &quot;element&quot;
##  $ panel.grid.major: list()
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_blank&quot; &quot;element&quot;
##  $ panel.grid.minor: list()
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_blank&quot; &quot;element&quot;
##  $ strip.background: list()
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_blank&quot; &quot;element&quot;
##  $ strip.text      :List of 10
##   ..$ family    : NULL
##   ..$ face      : chr &quot;bold&quot;
##   ..$ colour    : chr &quot;black&quot;
##   ..$ size      : num 13
##   ..$ hjust     : NULL
##   ..$ vjust     : NULL
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ strip.text.x    :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : NULL
##   ..$ size      : NULL
##   ..$ hjust     : NULL
##   ..$ vjust     : NULL
##   ..$ angle     : NULL
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ strip.text.y    :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : NULL
##   ..$ size      : NULL
##   ..$ hjust     : NULL
##   ..$ vjust     : NULL
##   ..$ angle     : num -90
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ axis.text.x     :List of 10
##   ..$ family    : NULL
##   ..$ face      : NULL
##   ..$ colour    : NULL
##   ..$ size      : NULL
##   ..$ hjust     : num 1
##   ..$ vjust     : NULL
##   ..$ angle     : num 90
##   ..$ lineheight: NULL
##   ..$ margin    : NULL
##   ..$ debug     : NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;theme&quot; &quot;gg&quot;
##  - attr(*, &quot;complete&quot;)= logi FALSE
##  - attr(*, &quot;validate&quot;)= logi TRUE</code></pre>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<ul>
<li>This modelling approach has the potential to make use of all the data.<br />
</li>
<li>It uses a robust statistical modelling approach.<br />
</li>
<li>The input structure is preserved in the output tibbles.<br />
</li>
<li>The model can be iteratively improved as more data is collected.<br />
</li>
<li>There is flexibility in the transition matrices that are used that should be estimated empirically in the future, data collection permitting.</li>
<li>The writing of a package allows us to enshrine business knowledge into a corpus of code that is inseparable from the documentation of that code.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.2 (2016-10-31)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 14393)
## 
## locale:
## [1] LC_COLLATE=C                           
## [2] LC_CTYPE=English_United Kingdom.1252   
## [3] LC_MONETARY=English_United Kingdom.1252
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] markovchain_0.6.5.1    dplyr_0.5.0            purrr_0.2.2           
## [4] readr_1.0.0            tidyr_0.6.0            tibble_1.2            
## [7] ggplot2_2.1.0          tidyverse_1.0.0        blockbuster_0.0.0.9001
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.7         plyr_1.8.4          tools_3.3.2        
##  [4] testthat_1.0.2      digest_0.6.11       memoise_1.0.0      
##  [7] evaluate_0.10       gtable_0.2.0        lattice_0.20-34    
## [10] Matrix_1.2-7.1      igraph_1.0.1        DBI_0.5-1          
## [13] yaml_2.1.14         parallel_3.3.2      expm_0.999-0       
## [16] withr_1.0.2         stringr_1.1.0       roxygen2_5.0.1     
## [19] knitr_1.15.1        devtools_1.12.0     stats4_3.3.2       
## [22] rprojroot_1.2       grid_3.3.2          R6_2.2.0           
## [25] rmarkdown_1.3       matlab_1.0.2        magrittr_1.5       
## [28] backports_1.0.4     scales_0.4.0        htmltools_0.3.5    
## [31] assertthat_0.1      govstyle_0.1.0      colorspace_1.2-7   
## [34] labeling_0.3        stringi_1.1.2       lazyeval_0.2.0     
## [37] RcppParallel_4.3.20 munsell_0.4.3       crayon_1.3.2</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
